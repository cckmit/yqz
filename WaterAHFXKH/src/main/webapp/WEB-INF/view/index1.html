<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>安徽防汛抗旱</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" href="static/css/mui.min.css"/>
    <link rel="stylesheet" href="static/css/icons-extra.css"/>
    <style>
        html,
        body,
        .mui-content,
        #tabbar1,
        #tabbar2 {
            background: #FAF9FF;
            height: 100%;
        }

        .mui-content > .mui-table-view:first-child {
            margin-top: 0;
        }

        h4.mui-ellipsis-1 {
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: 400;
        }

        .mui-navigate-right:after, .mui-push-right:after {
            transform: scale(1.3);
            margin-top: -2%;
        }

        .mui-content {
            padding-bottom: 50px;
        }

        #tabbar1, #tabbar2 {
            overflow: auto;
        }

        footer h6 {
            width: 100%;
            position: absolute;
            bottom: 4px;
            text-align: center;
            color: #C0C0C0;
            font-size: 10px;
        }

        footer p {
            position: absolute;
            bottom: 4px;
            cursor: pointer;
            width: 100%;
            text-align: center;
        }

        footer p img {
            width: 76px;
        }

        .syfq, .xhxx {
            background-size: 100% 100%;
            transform: scale(.8);
        }

        .syfq {
            background-image: url("static/img/syfq1.png");
        }

        .xhxx {
            background-image: url("static/img/xhxx1.png");
        }

        .syfq.active {
            background-image: url("static/img/syfq2.png");
        }

        .xhxx.active {
            background-image: url("static/img/xhxx2.png");
        }

        .mui-h4, h4 {
            height: 18px !important;
        }

        .mui-preview-image.mui-fullscreen {
            position: fixed;
            z-index: 20;
            background-color: #000;
        }

        .mui-preview-header,
        .mui-preview-footer {
            position: absolute;
            width: 100%;
            left: 0;
            z-index: 10;
        }

        .mui-preview-header {
            height: 44px;
            top: 0;
        }

        .mui-preview-footer {
            height: 50px;
            bottom: 0px;
        }

        .mui-preview-header .mui-preview-indicator {
            display: block;
            line-height: 25px;
            color: #fff;
            text-align: center;
            margin: 15px auto;
            width: 70px;
            background-color: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            font-size: 16px;
        }

        .mui-preview-image {
            display: none;
            -webkit-animation-duration: 0.5s;
            animation-duration: 0.5s;
            -webkit-animation-fill-mode: both;
            animation-fill-mode: both;
        }

        .mui-preview-image.mui-preview-in {
            -webkit-animation-name: fadeIn;
            animation-name: fadeIn;
        }

        .mui-preview-image.mui-preview-out {
            background: none;
            -webkit-animation-name: fadeOut;
            animation-name: fadeOut;
        }

        .mui-preview-image.mui-preview-out .mui-preview-header,
        .mui-preview-image.mui-preview-out .mui-preview-footer {
            display: none;
        }

        .mui-zoom-scroller {
            position: absolute;
            display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            -webkit-box-align: center;
            -webkit-align-items: center;
            align-items: center;
            -webkit-box-pack: center;
            -webkit-justify-content: center;
            justify-content: center;
            left: 0;
            right: 0;
            bottom: 0;
            top: 0;
            width: 100%;
            height: 100%;
            margin: 0;
            -webkit-backface-visibility: hidden;
        }

        .mui-zoom {
            -webkit-transform-style: preserve-3d;
            transform-style: preserve-3d;
        }

        .mui-slider .mui-slider-group .mui-slider-item img {
            width: auto;
            height: auto;
            max-width: 100%;
            max-height: 100%;
        }

        .mui-android-4-1 .mui-slider .mui-slider-group .mui-slider-item img {
            width: 100%;
        }

        .mui-android-4-1 .mui-slider.mui-preview-image .mui-slider-group .mui-slider-item {
            display: inline-table;
        }

        .mui-android-4-1 .mui-slider.mui-preview-image .mui-zoom-scroller img {
            display: table-cell;
            vertical-align: middle;
        }

        .mui-preview-loading {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            display: none;
        }

        .mui-preview-loading.mui-active {
            display: block;
        }

        .mui-preview-loading .mui-spinner-white {
            position: absolute;
            top: 50%;
            left: 50%;
            margin-left: -25px;
            margin-top: -25px;
            height: 50px;
            width: 50px;
        }

        .mui-preview-image img.mui-transitioning {
            -webkit-transition: -webkit-transform 0.5s ease, opacity 0.5s ease;
            transition: transform 0.5s ease, opacity 0.5s ease;
        }

        @-webkit-keyframes fadeIn {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }

        @-webkit-keyframes fadeOut {
            0% {
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }

        @keyframes fadeOut {
            0% {
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }

        p img {
            max-width: 100%;
            height: auto;
        }

        .mui-content ul, ul li {
            background: #FFFFFF !important;
        }

        .yjtg-icon:before {
            position: relative;
            top: 2px;
        }

        .my-bar {
            position: fixed;
            z-index: 10;
            right: 0;
            left: 0;
            height: 44px;
            padding-right: 10px;
            padding-left: 10px;
            border-bottom: 0;
            background-color: #f7f7f7;
            -webkit-box-shadow: 0 0 1px rgba(0, 0, 0, .85);
            box-shadow: 0 0 1px rgba(0, 0, 0, .85);
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
        }

        .my-bar-tab {
            bottom: 0;
            display: table;
            width: 100%;
            height: 50px;
            padding: 0;
            table-layout: fixed;
            border-top: 0;
            border-bottom: 0;
            -webkit-touch-callout: none;
        }

        .my-bar-tab .my-tab-item.my-active {
            color: #007aff;
        }

        .my-bar-tab .my-tab-item {
            display: table-cell;
            overflow: hidden;
            width: 1%;
            height: 50px;
            text-align: center;
            vertical-align: middle;
            white-space: nowrap;
            text-overflow: ellipsis;
            color: #929292;
        }

        .my-bar-tab .my-tab-item .mui-icon {
            top: 3px;
            width: 24px;
            height: 24px;
            padding-top: 0;
            padding-bottom: 0;
        }

        .my-bar-tab .my-tab-item .mui-icon ~ .my-tab-label {
            font-size: 11px;
            display: block;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .my-table-view {
            position: relative;
            margin-top: 0;
            margin-bottom: 0;
            padding-left: 0;
            list-style: none;
            background-color: #fff;
        }

        h4.mui-ellipsis-1 {
            width: 95%;
        }

        .yjtg {
            text-align: center;
            background-image: -webkit-linear-gradient(160deg, red 0%, #88f 1%, #88f 6%, red 20%, red 100%);
            -webkit-text-fill-color: transparent;
            -webkit-background-clip: text;
            animation: stream 4s ease-in infinite;
            background-size: 200% 100%;
        }

        @keyframes stream {
            75% {
                background-position: 0 0;
            }
            100% {
                background-position: -100% 0;
            }
        }
    </style>
</head>

<body>
<header class="mui-bar mui-bar-nav">
    <h1 class="mui-title">安徽防汛抗旱</h1>
</header>
<div class="mui-content">
    <div id="loading"><span></span></div>
    <div id="tabbar1" class="mui-control-content mui-active">

        <ul class="mui-table-view mui-grid-view mui-grid-9">
            <li data-href="http://yaoce.ahsl.gov.cn/YC_Small/LOL/yc/waterSmall.html"
                class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/sssq.png" width="50px"/>
                    <div class="mui-media-body">实时水情</div>
                </a>
            </li>
            <li data-href="http://yaoce.ahsl.gov.cn/YC_Small/LOL/yc/rainSmall.html"
                class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/jyfb.png" width="50px"/>
                    <div class="mui-media-body">降雨分布</div>
                </a>
            </li>
            <li data-href="http://yaoce.ahsl.gov.cn/tf-old.html"
                class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/tflj.png" width="50px"/>
                    <div class="mui-media-body">台风路径</div>
                </a>
            </li>
            <li data-href="http://wx.amo.org.cn/Index/yt"
                class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/wxyt.png" width="50px"/>
                    <div class="mui-media-body">卫星云图</div>
                </a>
            </li>
            <li data-href="http://yc.wswj.net/rainAPI/13.aspx"
                class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/dqyb.png" width="50px"/>
                    <div class="mui-media-body">短期预报</div>
                </a>
            </li>
            <li data-href="http://yc.wswj.net/ahyc/shzhqxyj.aspx"
                class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/qxyb.png" width="50px"/>
                    <div class="mui-media-body">气象预警</div>
                </a>
            </li>
            <li id="yjybLi" data-href="index-yjtg" style="display: none;">
                <a href="#">
                    <div class="mui-media-body"></div>
                </a>
            </li>
        </ul>

        <ul id="newsContainer1" class="my-table-view mui-table-view-striped mui-table-view-condensed"
            style="margin-top: 1em;">

            <li class="mui-table-view-cell" data-href="#">
                <div class="mui-table">
                    <div class="mui-table-cell mui-col-xs-10">
                        <span class="mui-icon mui-icon-extra mui-icon-extra-notice yjtg-icon"
                              style="color: #FF0000;"></span>
                        <span class="yjtg">预警通告</span>
                    </div>
                </div>
            </li>
            <#list yjtg as e>
                <li class="mui-table-view-cell" data-href="detail?url=${e.url}">
                    <a class="mui-navigate-right" href="#">
                        <div class="mui-table">
                            <div class="mui-table-cell mui-col-xs-10">
                                <h4 class="mui-ellipsis-1">${e.title}</h4>
                                <p class="mui-h6 mui-ellipsis" style="margin-top: 10px;">${e.time}</p>
                            </div>
                        </div>
                    </a>
                </li>
            </#list>

        </ul>

        <!--<footer>
            <p><img id="qrImg" src="static/img/shareclick.png" data-preview-src="static/img/qr.png" /></p>
            <h6>技术支持: 安徽沃特水务科技有限公司</h6>
        </footer>-->
    </div>

    <div id="tabbar2" class="mui-control-content">

        <ul class="mui-table-view mui-grid-view mui-grid-9">
            <li data-href="index-gzdt" class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/gzdt.png" width="50px"/>
                    <div class="mui-media-body">工作动态</div>
                </a>
            </li>
            <li data-href="index-tzgg" class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/tzgg.png" width="50px"/>
                    <div class="mui-media-body">通知公告</div>
                </a>
            </li>
            <li data-href="index-xhjb" class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/xhjb.png" width="50px"/>
                    <div class="mui-media-body">汛旱简报</div>
                </a>
            </li>
            <li data-href="index-hyjj" class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/hyjj.png" width="50px"/>
                    <div class="mui-media-body">行业聚焦</div>
                </a>
            </li>
            <li data-href="http://lhk.ahsl.gov.cn/fxkh/gclist.php"
                class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/gczl.png" width="50px"/>
                    <div class="mui-media-body">工程资料</div>
                </a>
            </li>
            <li data-href="index-flfg" class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                <a href="#">
                    <img src="static/img/flfg.png" width="50px"/>
                    <div class="mui-media-body">法律法规</div>
                </a>
            </li>
        </ul>

        <ul id="newsContainer2" class="my-table-view mui-table-view-striped mui-table-view-condensed"
            style="margin-top: 1em;">
            <li class="mui-table-view-cell" data-href="#">
                <div class="mui-table">
                    <div class="mui-table-cell mui-col-xs-10">
                        <span class="navTitle">工作动态</span>
                    </div>
                </div>
            </li>
            <#list gzdt as e>
                <li class="mui-table-view-cell" data-href="detail?url=${e.url}">
                    <a class="mui-navigate-right" href="#">
                        <div class="mui-table">
                            <div class="mui-table-cell mui-col-xs-10">
                                <h4 class="mui-ellipsis-1">${e.title}</h4>
                                <p class="mui-h6 mui-ellipsis" style="margin-top: 10px;">${e.time}</p>
                            </div>
                        </div>
                    </a>
                </li>
            </#list>

        </ul>

    </div>
</div>

<nav class="my-bar my-bar-tab">
    <a class="my-tab-item my-active" href="#tabbar1">
        <span class="mui-icon syfq active"></span>
        <span class="my-tab-label">水雨风情</span>
    </a>
    <a class="my-tab-item" href="#tabbar2">
        <span class="mui-icon xhxx"></span>
        <span class="my-tab-label">汛旱信息</span>
    </a>
</nav>

<script src="static/js/jquery.min.js"></script>
<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script src="static/js/mui.min.js"></script>
<script>
    $.ajax({
        url: 'sna',
        async: false,
        type: 'post',
        dataType: 'json',
        data: {
            "url": decodeURIComponent(location.href.split('#')[0])
        },
        success: function (data, textStatus) {
            if (textStatus == "success") {
                wx.config({
                    debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
                    appId: data.appid, // 必填，公众号的唯一标识
                    timestamp: data.timestamp, // 必填，生成签名的时间戳
                    nonceStr: data.nonceStr, // 必填，生成签名的随机串
                    signature: data.signature, // 必填，签名，见附录1
                    jsApiList: ["hideMenuItems", "hideAllNonBaseMenuItem"] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2
                });
                wx.ready(function () {
                    wx.hideAllNonBaseMenuItem();
                });
                wx.error(function (res) {
//                            mui.toast("未得到地理定位授权!");
                });
            }
            mui("#loading").progressbar().hide();
        },
        error: function (XMLHttpRequest, textStatus, errorThrown) {
//                    mui.toast("未得到地理定位授权!!");
        }
    });
</script>
<script>
    var HREF = window.location.href;
    if (/tabbar/.test(HREF)) {
        var tabID = HREF.substring(HREF.length - 8);
        $('.my-bar-tab a').attr('class', 'my-tab-item');
        $('.my-bar-tab a[href="' + tabID + '"]').attr('class', 'my-tab-item my-active');
        $('a.my-tab-item .mui-icon').removeClass('active');
        $('.my-bar-tab a[href="' + tabID + '"]').children('.mui-icon').addClass('active');
        $('.mui-control-content').removeClass('mui-active');
        $(tabID).addClass('mui-active');
    }

    mui.init();

    mui.ready(function () {
        // 设置li点击
        mui(".mui-table-view").on('tap', 'li', function () {
            var href = $(this).attr('data-href');
            console.log('href====' + href);
            if (href != null) {
                if (/^index-.*/.test(href)) {
                    mui("#loading").progressbar().show();
                    $('.navTitle').text($(this).children('a').children().text());
                    $.ajax({
                        type: 'get',
                        url: href,
                        dataType: 'json',
                        success: function (data) {
//									console.log(data);
                            var html = '';
                            if (data && data.length > 0) {
                                for (var i = 0; i < data.length; i++) {
                                    html += '<li class="mui-table-view-cell" data-href="detail?url=' + encodeURIComponent(data[i].url) + '">'
                                        + '<a class="mui-navigate-right" href="#">'
                                        + '<div class="mui-table">'
                                        + '<div class="mui-table-cell mui-col-xs-10">'
                                        + '<h4 class="mui-ellipsis-1">' + data[i].title + '</h4>'
                                        + '<p class="mui-h6 mui-ellipsis" style="margin-top: 10px;">' + (data[i].time || '') + '</p>'
                                        + '</div></div></a></li>';
                                }
                            }
                            if (href != 'index-yjgt') {
                                $('#newsContainer2 li:gt(0)').remove();
                                $('#newsContainer2').append(html);
                            } else {
                                $('#newsContainer1 li:gt(0)').remove();
                                $('#newsContainer1').append(html);
                            }
                            mui("#loading").progressbar().hide();
                        },
                        error: function () {
                            mui.toast('网络连接失败');
                            mui("#loading").progressbar().hide();
                        }
                    });
                } else {
                    mui.openWindow({
                        url: 'other.html?title=' + $(this).children('a').children('.mui-media-body').text() + '&href=' + href,
                        createNew: true,
                        show: {
                            duration: 200
                        }
                    });
                }
            }
        });
    });

    $('footer h6 span').click(function () {
        $('#qrImg').click();
    });


    // tabbar 切换
    $('.my-bar-tab').on('click', 'a', function () {
        $(this).parent().children('a').attr('class', 'my-tab-item');
        $(this).attr('class', 'my-tab-item my-active');
        $('a.my-tab-item .mui-icon').removeClass('active');
        $(this).children('.mui-icon').addClass('active')
        $('.mui-control-content').removeClass('mui-active');
        $($(this).attr('href')).addClass('mui-active');
        if (/tabbar/.test(HREF)) {
            window.location.href = HREF.replace(/#tabbar\d/, $(this).attr('href'));
        } else {
            window.location.href = HREF + $(this).attr('href');
        }
    });

    $('#newsContainer1,#newsContainer2').on('click', 'li', function () {
        var href = $(this).attr('data-href');
        mui.openWindow({
            url: href,
            createNew: true,
            show: {
                duration: 200
            }
        });
    });
</script>
</body>

</html>